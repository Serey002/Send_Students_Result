{% extends "base.html" %}

{% block title %}Dashboard - Student Result System{% endblock %}

{% block content %}
<div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900">Dashboard</h1>
    <p class="text-gray-600 mt-2">Welcome to the Student Result System</p>
</div>

<!-- Statistics Cards -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500">
        <div class="flex items-center">
            <div class="flex-shrink-0">
                <i class="fas fa-users text-blue-500 text-2xl"></i>
            </div>
            <div class="ml-4">
                <h3 class="text-lg font-semibold text-gray-900">Total Students</h3>
                <p class="text-3xl font-bold text-gray-700" id="total-students">0</p>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-green-500">
        <div class="flex items-center">
            <div class="flex-shrink-0">
                <i class="fas fa-paper-plane text-green-500 text-2xl"></i>
            </div>
            <div class="ml-4">
                <h3 class="text-lg font-semibold text-gray-900">Emails Sent</h3>
                <p class="text-3xl font-bold text-gray-700" id="sent-emails">0</p>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-red-500">
        <div class="flex items-center">
            <div class="flex-shrink-0">
                <i class="fas fa-exclamation-triangle text-red-500 text-2xl"></i>
            </div>
            <div class="ml-4">
                <h3 class="text-lg font-semibold text-gray-900">Failed Emails</h3>
                <p class="text-3xl font-bold text-gray-700" id="failed-emails">0</p>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-xl font-semibold text-gray-900 mb-4">Quick Actions</h3>
        <div class="space-y-4">
            <a href="{{ url_for('upload_file') }}" 
               class="w-full flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-blue-50 transition duration-300">
                <div class="flex items-center">
                    <i class="fas fa-upload text-blue-500 text-xl mr-3"></i>
                    <span class="font-medium">Upload Student Results</span>
                </div>
                <i class="fas fa-chevron-right text-gray-400"></i>
            </a>
            
            <a href="{{ url_for('view_results') }}" 
               class="w-full flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-green-50 transition duration-300">
                <div class="flex items-center">
                    <i class="fas fa-list text-green-500 text-xl mr-3"></i>
                    <span class="font-medium">View All Results</span>
                </div>
                <i class="fas fa-chevron-right text-gray-400"></i>
            </a>
            
            <a href="{{ url_for('view_logs') }}" 
               class="w-full flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-purple-50 transition duration-300">
                <div class="flex items-center">
                    <i class="fas fa-history text-purple-500 text-xl mr-3"></i>
                    <span class="font-medium">Check Email Logs</span>
                </div>
                <i class="fas fa-chevron-right text-gray-400"></i>
            </a>
        </div>
    </div>

    <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-xl font-semibold text-gray-900 mb-4">System Information</h3>
        <div class="space-y-3 text-gray-600">
            <div class="flex justify-between">
                <span>Success Rate:</span>
                <span class="font-medium" id="success-rate">0%</span>
            </div>
            <div class="flex justify-between">
                <span>Last Updated:</span>
                <span class="font-medium" id="last-updated">Just now</span>
            </div>
            <div class="flex justify-between">
                <span>System Status:</span>
                <span class="font-medium text-green-600">Operational</span>
            </div>
        </div>
        
        <div class="mt-6 p-4 bg-blue-50 rounded-lg">
            <h4 class="font-semibold text-blue-900 mb-2">Need Help?</h4>
            <p class="text-blue-700 text-sm">
                Check the documentation for file format requirements and troubleshooting guide.
            </p>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Load statistics
function loadStats() {
    fetch('/api/stats')
        .then(response => response.json())
        .then(data => {
            document.getElementById('total-students').textContent = data.total_students;
            document.getElementById('sent-emails').textContent = data.sent_emails;
            document.getElementById('failed-emails').textContent = data.failed_emails;
            document.getElementById('success-rate').textContent = data.success_rate + '%';
            document.getElementById('last-updated').textContent = 'Just now';
        })
        .catch(error => {
            console.error('Error loading stats:', error);
        });
}

// Load stats on page load
document.addEventListener('DOMContentLoaded', loadStats);

// Refresh stats every 30 seconds
setInterval(loadStats, 30000);
</script>
{% endblock %}